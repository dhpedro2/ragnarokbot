<!DOCTYPE html>
<html>
<head>
    <title>Site</title>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
</head>
<body>
    <h1>Bagulho de level</h1>
    <form id="formNome">
        <label for="nome">Nome:</label>
        <select id="nome" name="nome">
            <option value="Beelzebulb">Beelzebulb</option>
            <option value="Orpheu">Orpheu</option>
            <option value="Arthur Maquiavel">Arthur Maquiavel</option>
            <option value="Alexandre">Alexandre</option>
            <option value="Luis Alberto">Luis Alberto</option>
            <option value="Akio Sato">Akio Sato</option>
            <option value="Lohanna Armani">Lohanna Armani</option>
        </select>
        <br>
        <label for="numero">Level:</label>
        <input type="text" id="numero" name="numero">
        <br>
        <input type="submit" value="Enviar">
    </form>

    <h2>Dados Salvos:</h2>
    <ul id="dadosList"></ul>

    <script>
// Configurações do Firebase
        var firebaseConfig = {
            apiKey: 'AIzaSyBbSlF8mV-N-NG8IzGBTcwUrAV3QfwSh0k',
            authDomain: 'raga-df841.firebaseapp.com',
            projectId: 'raga-df841',
            databaseURL: 'https://raga-df841-default-rtdb.firebaseio.com/',
            storageBucket: 'raga-df841.appspot.com',
            messagingSenderId: '822434274243',
            appId: '1:822434274243:web:349f2172db5a4289b37b76'
        };

    // Inicializa o app do Firebase
    firebase.initializeApp(firebaseConfig);

    // Obtém uma referência para o Realtime Database do Firebase
    var database = firebase.database();

    // Evento de envio do formulário
    document.getElementById('formNome').addEventListener('submit', function(event) {
        event.preventDefault(); // Impede o envio do formulário padrão

        var nome = document.getElementById('nome').value;
        var numero = document.getElementById('numero').value;

        // Verifica se o nome já existe no banco de dados
        database.ref('nomes').orderByChild('nome').equalTo(nome).once('value', function(snapshot) {
            if (snapshot.exists()) {
                // Atualiza o número associado ao nome existente
                snapshot.forEach(function(childSnapshot) {
                    var key = childSnapshot.key;
                    database.ref('nomes/' + key).update({ numero: numero });
                });
            } else {
                // Salva um novo registro no banco de dados
                database.ref('nomes').push({ nome: nome, numero: numero });
            }
        });

        // Limpa os campos do formulário após o envio
        document.getElementById('numero').value = '';
    });

    // Monitora as alterações no Realtime Database e atualiza a tabela
    database.ref('nomes').on('value', function(snapshot) {
        var dadosTable = document.getElementById('dadosTable');
        dadosTable.innerHTML = '';

        var headerRow = document.createElement('tr');
        var headerNome = document.createElement('th');
        headerNome.innerText = 'Nome';
        var headerNumero = document.createElement('th');
        headerNumero.innerText = 'Level';
        headerRow.appendChild(headerNome);
        headerRow.appendChild(headerNumero);
        dadosTable.appendChild(headerRow);

        snapshot.forEach(function(childSnapshot) {
            var nome = childSnapshot.val().nome;
            var numero = childSnapshot.val().numero;

            var dataRow = document.createElement('tr');
            var dataNome = document.createElement('td');
            dataNome.innerText = nome;
            var dataNumero = document.createElement('td');
            dataNumero.innerText = numero;
            dataRow.appendChild(dataNome);
            dataRow.appendChild(dataNumero);
            dadosTable.appendChild(dataRow);
        });
    });
</script>
</body>
</html>
