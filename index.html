<!DOCTYPE html>
<html>
<head>
    <title>Formulário de Nomes</title>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
</head>
<body>
    <h1>Formulário de Nomes</h1>
    <form id="formNome">
        <label for="nome">Nome:</label>
        <select id="nome" name="nome">
            <option value="Beelzebulb">Beelzebulb</option>
            <option value="Orpheu">Orpheu</option>
            <option value="Arthur Maquiavel">Arthur Maquiavel</option>
            <option value="Alexandre">Alexandre</option>
            <option value="Luis Alberto">Luis Alberto</option>
            <option value="Akio Sato">Akio Sato</option>
            <option value="Lohanna Armani">Lohanna Armani</option>
        </select>
        <br>
        <label for="numero">Número:</label>
        <input type="text" id="numero" name="numero">
        <br>
        <label for="id">ID:</label>
        <input type="text" id="id" name="id">
        <br>
        <input type="submit" value="Enviar">
    </form>

    <h2>Dados Salvos:</h2>
    <ul id="dadosList"></ul>

    <script>
// Configurações do Firebase
        var firebaseConfig = {
            apiKey: 'AIzaSyBbSlF8mV-N-NG8IzGBTcwUrAV3QfwSh0k',
            authDomain: 'raga-df841.firebaseapp.com',
            projectId: 'raga-df841',
            databaseURL: 'https://raga-df841-default-rtdb.firebaseio.com/',
            storageBucket: 'raga-df841.appspot.com',
            messagingSenderId: '822434274243',
            appId: '1:822434274243:web:349f2172db5a4289b37b76'
        };

        // Inicializa o app do Firebase
        firebase.initializeApp(firebaseConfig);

        // Obtém uma referência para o Realtime Database do Firebase
        var database = firebase.database();

        // Evento de envio do formulário
        document.getElementById('formNome').addEventListener('submit', function(event) {
            event.preventDefault(); // Impede o envio do formulário padrão

            var nome = document.getElementById('nome').value;
            var numero = document.getElementById('numero').value;
            var id = document.getElementById('id').value;

            // Verifica se o nome já existe no banco de dados
            database.ref('nomes').orderByChild('nome').equalTo(nome).once('value', function(snapshot) {
                if (snapshot.exists()) {
                    // Atualiza o número e o ID associados ao nome existente
                    snapshot.forEach(function(childSnapshot) {
                        var key = childSnapshot.key;
                        database.ref('nomes/' + key).update({ numero: numero, id: id });
                    });
                } else {
                    // Salva um novo registro no banco de dados
                    database.ref('nomes').push({ nome: nome, numero: numero, id: id });
                }
            });

            // Limpa os campos do formulário após o envio
            document.getElementById('numero').value = '';
            document.getElementById('id').value = '';
        });

        // Monitora as alterações no Realtime Database e atualiza a lista
        database.ref('nomes').on('value', function(snapshot) {
            var dadosList = document.getElementById('dadosList');
            dadosList.innerHTML = '';

            snapshot.forEach(function(childSnapshot) {
                var nome = childSnapshot.val().nome;
                var numero = childSnapshot.val().numero;
                var id = childSnapshot.val().id;

                var listItem = document.createElement('li');
                listItem.innerText = nome + ' - ' + numero + ' - ' + id;

                dadosList.appendChild(listItem);
            });
        });
    </script>
</body>
</html>
